---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# tccR4ds2

<!-- badges: start -->
<!-- badges: end -->

O objetivo desse pacote é servir de repositório para as análises do TCC do curso de R4DS2 
da curso-R, turma de abril de 2021.

## Instalação

``` r
# install.packages("devtools")
devtools::install_github("mendoncalf/tccR4ds2")
```
## Por qual aeroporto devo chegar aos EUA? 

Segundo a postagem do site [passageiro de primeira](https://passageirodeprimeira.com/lista-das-companhias-aereas-que-ainda-estao-voando-entre-os-eua-e-o-brasil/) os aeroportos nos EUA que mais recebem voos do Brasil são: Miami (MIA), Orlando (MCO), Nova York (JFK), Atlanta (ATL), Houston (IAH) e Fort Lauderdale (FLL). 

Nesse contexto, nos propomos a analisar quais desses aeroportos seria a melhor opção para um Brasileiro chegar aos EUA. Ignorando parâmetros de preço de passagem aérea, e usando as bases de dados do pacote [`anyflights`](https://github.com/simonpcouch/anyflights), vamos avaliar a performance desses 6 aeroportos com base em **atrasos**,  **número de companhias aéreas**, **oferta de destinos**, e **conexões com destinos chave**. Foram considerados apenas os voos do ano de 2019 para a análise.

### 1 - Atraso

```{r echo = FALSE, warning=FALSE, message = FALSE, fig.align='center'}

devtools::load_all()

plot_atraso(col = atraso_partida,
            title = 'partida > 30min',
            atraso_min = lubridate::make_difftime(60*30))


plot_atraso(col = atraso_chegada,
            title = 'chegada > 30min',
            atraso_min = lubridate::make_difftime(60*30))


plot_atraso_serie(atraso_min = lubridate::make_difftime(60*30))


```

### 2 - Número de companhas aéreas

```{r echo = FALSE, warning=FALSE, message = FALSE, fig.align='center'}

plot_count(col = companhia , title = 'Numero de companhia aéreas operando voos')

```


### 3 - Oferta de destinos

```{r echo = FALSE, warning=FALSE, message = FALSE, fig.align='center'}

destinos_semana(min_ocorencias = 100, title = "Destinos por dia da semana")

```

### 4 - Oferta de destinos especiais

```{r echo = FALSE, warning=FALSE, message = FALSE, fig.align='center'}

destinos_semana(destinos = c('SFO', 'LAX', 'LAS', 'BOS', 'IAD', 'ORD'),
                             min_ocorencias = 100,title = "Destinos clave por dia da semana")

```


### Extra - Curiosidade: maiores atrasos e antecipações de cada aeroporto

```{r echo = FALSE, warning=FALSE, message = FALSE, fig.align='center'}
meus_voos %>%
  dplyr::group_by(origem) %>%
  tidyr::nest() %>%
  dplyr::mutate(maximo_atraso = purrr::map(data ,max_atraso)) %>%
  dplyr::select(origem, maximo_atraso) %>%
  tidyr::unnest(cols = c(maximo_atraso)) %>%
  dplyr::mutate(atraso_partida = lubridate::seconds_to_period(atraso_partida)) %>%
  dplyr::select(origem, destino, data,atraso_partida) %>%
  dplyr::arrange(desc(atraso_partida)) %>%
  knitr::kable()


```

```{r echo = FALSE, warning=FALSE, message = FALSE, fig.align='center'}

meus_voos %>%
  dplyr::group_by(origem) %>%
  tidyr::nest() %>%
  dplyr::mutate(maximo_atraso = purrr::map(data ,max_antecipado)) %>%
  dplyr::select(origem, maximo_atraso) %>%
  tidyr::unnest(cols = c(maximo_atraso)) %>%
  dplyr::mutate(atraso_partida = lubridate::seconds_to_period(atraso_partida)) %>%
  dplyr::select(origem, destino, data,atraso_partida) %>%
  dplyr::rename('antecipacao_partida' = atraso_partida) %>% 
  dplyr::arrange((antecipacao_partida)) %>%
  knitr::kable()


```


